<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Mktbot</title>
</head>

<body>
    <div id="root"></div>
    <script src="https://unpkg.com/react@17.0.2/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@17.0.2/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/js-cookie@3.0.1/dist/js.cookie.min.js"></script>
    <script type="text/javascript">
        (function storeCookie() {
            const accessToken = Cookies.get("access_token")

            const fragment = window.location.hash.substring(1);
            let fragmentSplitted = fragment.split('&');
            let fragments = {}
            fragmentSplitted.map(function(f) {
                let pair = f.split("=");
                if (pair.length === 2) {
                    Cookies.set(pair[0], pair[1]);
                }
            })

            if (accessToken != Cookies.get("access_token")) {
                const expiresIn = Cookies.get("expires_in") || "1800";
                Cookies.set("expires_at", Math.floor(parseInt(expiresIn) + new Date().getTime() / 1000 - 300));
            }
        })();

        function App() {
            function handleClick() {
                fetch('/api')
                    .then(function(response) {
                        return response.json();
                    })
                    .then(function(data) {
                        console.log(data);
                    })
                    .catch(function (error) {
                        console.error(error);
                    });
            }

            return (
                React.createElement("div", null,
                    React.createElement("div", { onClick: handleClick }, "Portfolio")
                )
            );
        }

        ReactDOM.render(
            React.createElement(App),
            document.getElementById('root')
        );
    </script>
</body>

</html>